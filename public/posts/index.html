<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Tristan's Blog</title>
<meta name=keywords content><meta name=description content="Posts - Tristan's Blog"><meta name=author content="Tristan"><link rel=canonical href=http://localhost:1313/posts/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.392aecb5c92792e8888f6bee404f8c562ed37691c3e5e0914aa5cd0a29ec8350.css integrity="sha256-OSrstcknkuiIj2vuQE+MVi7TdpHD5eCRSqXNCinsg1A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/favicon/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=http://localhost:1313/posts/index.xml><link rel=alternate hreflang=en href=http://localhost:1313/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css integrity=sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js integrity=sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})'></script><meta property="og:url" content="http://localhost:1313/posts/"><meta property="og:site_name" content="Tristan's Blog"><meta property="og:title" content="Posts"><meta property="og:description" content="A personal blog focused on software development, AI technology,  and programming tutorials. Here I share my learning journey  and technical insights in computer science and machine learning."><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content="A personal blog focused on software development, AI technology,  and programming tutorials. Here I share my learning journey  and technical insights in computer science and machine learning.
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Tristan's Blog (Alt + H)">Tristan's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/archives/ title=Archive><span>Archive</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/resume/ title=Resume><span>Resume</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a></div><h1>Posts
<a href=/posts/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>NLP09
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p></p></div><footer class=entry-footer><span title='2025-03-24 11:41:56 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;0 min&nbsp;·&nbsp;0 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to NLP09" href=http://localhost:1313/posts/nlp09/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>NLP08
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p></p></div><footer class=entry-footer><span title='2025-03-24 11:41:52 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;0 min&nbsp;·&nbsp;0 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to NLP08" href=http://localhost:1313/posts/nlp08/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>NLP07
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p></p></div><footer class=entry-footer><span title='2025-03-24 11:41:49 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;0 min&nbsp;·&nbsp;0 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to NLP07" href=http://localhost:1313/posts/nlp07/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>NLP06
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p></p></div><footer class=entry-footer><span title='2025-03-24 11:41:43 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;0 min&nbsp;·&nbsp;0 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to NLP06" href=http://localhost:1313/posts/nlp06/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>RNN and NLP Study Notes 05
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>Making RNNs More Effective 包含三个方面：Stacked RNN、Bidirectional RNN、Pretrain
Stacked RNN 可以将很多全连接层堆叠起来，构成一个MLP；可以把很多卷积层堆叠起来，构成一个深度卷积网络；同样的道理，你可以将很多RNN堆叠起来，构成一个多层RNN网络；神经网络每一步都会更新状态h，新算出来的h有两个copies；一个送到下一个时刻，另一个作为输出，这一层的输出h成为了下一层的输入；
最底层的RNN的输入为词向量x；这些词向量的输出h会作为下一层RNN的输入；
![image-20250325234633209](../../../../Library/Application Support/typora-user-images/image-20250325234633209.png)
最上层的状态为RNN的输出；最上层的最后一个状态h_t为最终的状态h_t，
Bidirectional RNN Standard RNN和人的阅读习惯一样，从左往右阅读；人阅读的过程在脑子里积累阅读的信息；RNN在状态向量h_t中积累阅读到的信息；读完一份电影评论则可以知道是正面评价还是负面评价；我们人类总是从前往后，从左往右进行阅读；但是这只是人类的阅读习惯，从后往前阅读依旧可以判断电影评价是正面的还是负面的；对RNN来说，从前往后阅读或者从后往前阅读，是没有太大区别的，训练一个从后往前阅读的RNN，也会有一个比较不错的结果；所以比较自然的想法就是训练两条RNN，一条从左往右读，一条从右往左读；两条RNN是独立的，不共享参数，也不共享状态；两条RNN各自输出自己的状态向量，然后把它们的状态向量做cat；记做向量y；如果有多层RNN，就将这些y作为更上一层RNN的输入；如果只有一层RNN，则可以将y丢弃，只保留两条链最后的状态h_t和h_t‘；把这两个向量的cat作为从输入文本中提取出的特征向量；把这个向量用于判断是正面还是负面；
![image-20250326000815290](../../../../Library/Application Support/typora-user-images/image-20250326000815290.png)
双向RNN总是比单向RNN效果好；原因可能是这样的，无论哪个方向，或多或少会忘记最开始的输入；从左往右阅读可能忘记最左边的内容；反之亦然；
Pretrain 预训练在深度学习中非常好用，比如在卷积神经网络中，如果网络太大而训练集不够大，那么可以在ImageNet大数据上做预训练；这样可以让神经网络有比较好的初始化，也可以避免Overfitting；训练RNN同理；例如这里Embedding层有320000参数，而我们只有2w个训练样本；这个Embedding太大了，会导致overfitting；解决办法就是对Embedding层做预训练；
![image-20250326001446063](../../../../Library/Application Support/typora-user-images/image-20250326001446063.png)
预训练具体如下；首先找一个更大的数据集，可以是情感分析的数据，也可以是其他类型的数据；但是任务最好是接近原来情感分析的任务；最好学习到的词向量带有正面或者负面情感；两个任务越相似，预训练之后的transfer就会越好；有了大数据集之后，要搭建一个神经网络，这个神经网络的结构是什么样都可以，甚至不用是RNN，只要这个神经网络有embedding层即可；然后就是在大数据集上训练这个神经网络；
![image-20250326001629650](../../../../Library/Application Support/typora-user-images/image-20250326001629650.png)
训练好之后，丢掉上面的层，只保留Embedding层和训练好的模型参数；
![image-20250326002121770](../../../../Library/Application Support/typora-user-images/image-20250326002121770.png)
然后再搭我们自己的RNN网络；这个新的RNN网络和之前预训练的可以有不同的结构，搭好之后，新的RNN层和全连接层都是随机初始化的，而下面的Embedding层的参数是预训练出来的，要固定住Embedding层的参数，不训练Embedding，只训练其他层；
Summary SimpleRNN and LSTM are two kinds of RNNs; always use LSTM instead of SimpleRNN. Use Bi-RNN instead of RNN whenever possible. Stacked RNN may be better than a single RNN layer (if $n$ is big). Pretrain the embedding layer (if $n$ is small). 还有一些其他的RNN替代，例如GRU，Gated R Unit；但是不一定比LSTM好。
...</p></div><footer class=entry-footer><span title='2025-03-24 11:41:39 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;79 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to RNN and NLP Study Notes 05" href=http://localhost:1313/posts/nlp05/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>RNN and NLP Study Notes 04
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>Long Short Term Memory (LSTM) LSTM Model Long Short-Term Memory networks (LSTM) are a specialized type of recurrent neural network (RNN) designed to effectively handle dependencies in long sequence data. Traditional RNNs often face the problem of forgetting when processing long time sequences, making it difficult to retain important information. LSTM addresses this issue by introducing a “cell state” mechanism that allows information to flow directly across time steps, helping the network better capture long-term dependencies.
...</p></div><footer class=entry-footer><span title='2025-03-24 11:41:35 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1718 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to RNN and NLP Study Notes 04" href=http://localhost:1313/posts/nlp04/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>RNN and NLP Study Notes 03</h2></header><div class=entry-content><p>Recurrent Neural Networks (RNNs) How to model sequential data? In deep learning, the key to processing sequential data lies in understanding the relationship between inputs and outputs. Generally, the input-output relationships of data can be divided into three categories: one-to-one, one-to-many, and many-to-many. A one-to-one relationship means that each input has a corresponding output, which is commonly used in image classification. In contrast, a one-to-many relationship indicates that a single input can produce multiple outputs, suitable for generation tasks, such as a chatbot generating multiple responses based on user input. Meanwhile, a many-to-many relationship involves multiple inputs leading to multiple outputs, typically used in sequence transformation tasks, such as machine translation.
...</p></div><footer class=entry-footer><span title='2025-03-24 11:41:32 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1192 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to RNN and NLP Study Notes 03" href=http://localhost:1313/posts/nlp03/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>RNN and NLP Study Notes 02</h2></header><div class=entry-content><p>Text Processing and Word Embedding Text to Sequence Processing text data is crucial for natural language processing (NLP) and machine learning applications. This section outlines the key steps in processing text data.
Step 1: Tokenization The first step in text processing is tokenization, which involves breaking down a text string into a list of individual words. For example, given the text:
1 S = "Machine learning is an important branch of artificial intelligence" Breaking this string into a word list:
...</p></div><footer class=entry-footer><span title='2025-03-24 11:41:20 +0800 HKT'>March 24, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1377 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to RNN and NLP Study Notes 02" href=http://localhost:1313/posts/nlp02/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>RNN and NLP Study Notes 01</h2></header><div class=entry-content><p>Data Processing Basics In machine learning, data types can be classified into several forms, including numeric features, categorical features, and binary features. The table below provides concrete examples to better understand these data types:
Age Gender Nationality 35 Male US 31 Male China 29 Female India 27 Male US Numeric Features Numeric features refer to data that possess additive properties and can be compared in magnitude. For example, a person’s age serves as a numeric feature, where 35 is greater than 31.
...</p></div><footer class=entry-footer><span title='2025-03-23 21:43:18 +0800 HKT'>March 23, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1125 words&nbsp;·&nbsp;Tristan</footer><a class=entry-link aria-label="post link to RNN and NLP Study Notes 01" href=http://localhost:1313/posts/nlp01/></a></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Tristan's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>